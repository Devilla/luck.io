# RNG and Oracle Control Analysis

**Luck.io relies on Proov’s VRF-based random number generation, which is advertised as decentralized but is, in fact, under centralized control.** We examined how the RNG is produced and identified a potential vulnerability: because the same team controls all oracle nodes, they could manipulate outcomes by selective publication of random seeds.

**VRF Oracles and Potential Manipulation:** The Proov network uses multiple oracle signers to generate each random outcome. In principle, requiring several independent oracles to sign a VRF output is meant to prevent any single party from tampering with the randomness\[[1](https://dev-koold.gitbook.io/crypto/evidence#id-1-oracle-signer-transactions-list)]. However, our investigation found **no evidence that these oracles are run by independent parties** – on the contrary, all known VRF signer keys are likely operated or authorized by the Luck.io/Proov team\[[1](https://dev-koold.gitbook.io/crypto/evidence)]\[[2](https://dev-koold.gitbook.io/crypto/evidence#id-2-same-signer-used-across-multiple-users-games)]. The oracle network is closed to external operators (no public instructions for anyone to run a node), indicating a permissioned setup\[[3](https://dev-koold.gitbook.io/crypto/evidence#id-3-no-public-instructions-to-run-an-oracle-node)]. Four oracle public keys were identified in the Proov code, suggesting a fixed small signer set fully under project control.

Crucially, **nothing in the on-chain protocol prevents the oracles from re-rolling random outputs before finalizing a result**. Because bets are initiated off-chain and only the final VRF result is posted on-chain, a malicious or insider-controlled oracle could internally generate many candidate random values and **only publish the one that favors the house**\[[4](https://dev-koold.gitbook.io/crypto/evidence#id-4-no-on-chain-commit-to-bet-no-commit-reveal)]\[[6](https://dev-koold.gitbook.io/crypto/evidence#id-6-off-chain-oracle-generates-vrf-only-final-posted)]. There is no commit-reveal or timestamp binding the random seed to the moment the bet was placed: - **No pre-commitment:** The system does not hash or commit the user’s bet and a random nonce on-chain before revealing the random number\[[6](https://dev-koold.gitbook.io/crypto/evidence#id-6-off-chain-oracle-generates-vrf-only-final-posted)]. This means the oracle’s VRF generation isn’t verifiably tied to a unique bet ID or timestamp at the time of bet placement. - **No enforced timestamp/slot:** The VRF output isn’t derived from a specific blockchain slot or block hash; it’s purely generated by the off-chain oracles and then submitted. An oracle could delay responding until it finds a favorable number. - **Duplicate nonce risk:** While each bet has a nonce/counter, the protocol doesn’t enforce that only one VRF output can be produced per nonce in real time. The oracles could discard a result and generate a new one under the same nonce if done privately.

This selective publishing attack means the **VRF randomness, though cryptographically verifiable after the fact, cannot guarantee fairness if the source is untrusted**\[[13](evidence.md#id-13-no-published-rtp-odds-per-game-on-chain)]. Our team demonstrated this conceptually: by simulating the VRF process, we found that it was possible to iterate multiple VRF attempts for a given bet until a losing outcome was found, and then use that as the “official” result. In one example, a bet that would have won (target multiplier 25x, initial VRF gave a win at \~29.44x) was **re-rolled into a losing outcome** simply by trying a different VRF proof – underscoring that “so much for having VRF” if the oracles are colluding. Once the losing VRF proof was published on-chain, it appears perfectly legitimate to observers, even though it was potentially cherry-picked.

**Lack of Oracle Governance:** Another issue is the absence of any on-chain governance or rotation for the oracle nodes. We did not find a public set\_oracle\_signers function or similar admin interface in the audited contracts that would allow a community or decentralized mechanism to change or add oracles\[[32](evidence.md#id-32-no-public-dao-governance-no-spl-governance-links)]. All control of oracle selection lies off-chain with the team. This means **trust in RNG = trust in the team’s honesty**, a centralization that conflicts with the “provably fair” ethos. The Halborn audit’s findings also highlight this as an acknowledged issue: “Reliance on off-chain critical logic” (the VRF mechanism being off-chain) was noted, implying the fairness of randomness ultimately depends on an off-chain process\[[47](evidence.md#id-47-one-bet-timeline)].

In summary, **the RNG is only partially decentralized**. The VRF approach would provide strong fairness guarantees if the oracles were truly independent or if a commit-reveal scheme prevented reseeding. In Luck.io’s current design, however, **the operator has the technical capability to influence random outcomes** undetected, presenting a **critical risk to game fairness:** - Probability of exploitation: Only the insider team or a compromise of their oracle keys would be required – no complex hack needed, just abuse of authority\[[1](evidence.md#id-1-oracle-signer-transactions-list)]\[[2](evidence.md#id-2-same-signer-used-across-multiple-users-games)]. - Impact: This could covertly tilt odds (e.g. prevent jackpots or big wins) while still showing legitimate VRF proofs on-chain, breaking the trust of the “provable fairness” claim\[[38](evidence.md#id-38-screenshot-of-provably-fair-for-every-spin-claim)].

**Player Seed (Client Seed) Implementation – Cosmetic Only:** Luck․io’s recently added “Custom Seed” (player seed) input gives the impression that users can influence randomness\[[42](evidence.md#id-42-no-client-seed-input-ui)], but review of the Proov VRF integration and bet logs confirms it has no cryptographic effect on outcomes\[[45](evidence.md#id-45-example-bet-log-with-no-player-seed-binding)]. The value is accepted in the UI but not combined with the Proov VRF hash or stored on-chain, providing no verifiable linkage between player input and the resulting RNG \[[43](evidence.md#id-43-no-path-to-reproduce-outcome-from-seed)]\[[44](evidence.md#id-44-explorer-shows-logs-not-pre-commit-proofs)]. In effect, the feature is purely cosmetic—randomness remains entirely dependent on team-controlled oracles\[[45](evidence.md#id-45-example-bet-log-with-no-player-seed-binding)].

**Mitigations:** To address this, we recommend (details in Conclusion) that Luck.io/Proov integrate **on-chain enforcement for randomness** (e.g. using an external oracle like Chainlink VRF which automatically includes commit and reveal tied to a specific request) or implement a system where the user’s bet and a random seed commitment are posted on-chain before the actual random draw\[[45](evidence.md#id-45-example-bet-log-with-no-player-seed-binding)]\[[46](evidence.md#id-46-3-real-bets-with-full-fields-csv)]. Additionally, opening the oracle set to multiple independent operators or a DAO-run oracle pool would vastly improve trust in the RNG process\[[32](evidence.md#id-32-no-public-dao-governance-no-spl-governance-links)]\[[50](evidence.md#id-50-comparision-and-architecture-upgrades)].
